{% extends 'base.html' %}

{% block title %}Nouvelle d√©pense{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="page-header">
    <div>
        <h1 class="page-title">üì§ Nouvelle D√©pense</h1>
        <p class="page-subtitle">Enregistrez une sortie de caisse</p>
    </div>
</div>

<div class="grid grid--content-sidebar">
    <!-- Formulaire -->
    <div class="card">
        <div class="card__header">
            <h3 class="card__title">D√©tails de la d√©pense</h3>
        </div>
        
        <form method="post" enctype="multipart/form-data" class="form">
            {% csrf_token %}

            <div class="form-group">
                <label class="form-label">Type de d√©pense *</label>
                <select name="type_depense" class="form-select" required>
                    <option value="">S√©lectionnez un type...</option>
                    {% for t in types_depense %}
                        <option value="{{ t.id }}">{{ t.nom }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label class="form-label">Montant (‚Ç¨) *</label>
                <input class="form-input" name="montant" type="number" step="0.01" min="0.01" placeholder="0.00" required>
                <span class="form-hint">Le montant sera d√©duit du solde de la caisse</span>
            </div>

            <div class="form-group">
                <label class="form-label">Motif *</label>
                <input class="form-input" name="motif" type="text" placeholder="Ex: Achat de fournitures" required>
            </div>

            <div class="form-group">
                <label class="form-label">Justificatif (optionnel)</label>
                <input class="form-input" name="justificatif" type="file" accept="image/*,.pdf">
                <span class="form-hint">Formats accept√©s: Images, PDF</span>
            </div>

            <div class="form-group">
                <label class="form-label">Notes additionnelles</label>
                <textarea name="notes" class="form-textarea" rows="3" placeholder="Informations suppl√©mentaires..."></textarea>
            </div>

            <div class="btn-group" style="margin-top: 24px;">
                <button class="btn btn--primary btn--lg" type="submit">
                    üì§ Enregistrer la d√©pense
                </button>
                <a class="btn btn--ghost" href="{% url 'payments:dashboard_caisse' %}">Annuler</a>
            </div>
        </form>
    </div>
    
    <!-- Infos caisse -->
    <div>
        <div class="card" style="margin-bottom: 20px;">
            <div class="card__header">
                <h3 class="card__title">üí∞ Solde actuel</h3>
            </div>
            {% if caisse %}
            <div style="text-align: center; padding: 20px 0;">
                <div style="font-size: 36px; font-weight: 700; color: var(--accent-success);">
                    {{ caisse.solde_actuel|floatformat:2 }}‚Ç¨
                </div>
                <p style="color: var(--text-secondary); margin-top: 8px;">Disponible en caisse</p>
            </div>
            {% else %}
            <div class="empty-state">
                <p>Aucune caisse ouverte</p>
            </div>
            {% endif %}
        </div>
        
        <div class="card">
            <div class="card__header">
                <h3 class="card__title">‚ÑπÔ∏è Information</h3>
            </div>
            <div style="color: var(--text-secondary); font-size: 14px; line-height: 1.6;">
                <p style="margin-bottom: 12px;">
                    <strong>‚ö†Ô∏è Important :</strong> Le montant de la d√©pense sera automatiquement d√©duit du solde de la caisse.
                </p>
                <p style="margin-bottom: 12px;">
                    Vous ne pouvez pas enregistrer une d√©pense sup√©rieure au solde disponible.
                </p>
                <p>
                    N'oubliez pas de joindre un justificatif pour les d√©penses importantes.
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}
