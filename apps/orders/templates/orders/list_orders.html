{% extends 'base.html' %}

{% block title %}Commandes{% endblock %}

{% block content %}
<!-- Page Header -->
<div class="page-header">
    <div>
        <h1 class="page-title">ğŸ“‹ Gestion des Commandes</h1>
        <p class="page-subtitle">Suivez et gÃ©rez toutes les commandes en temps rÃ©el</p>
    </div>
</div>

<!-- Filtres rapides -->
<div class="card" style="padding: 12px 16px; margin-bottom: 24px;">
    <div class="btn-group">
        <a href="?statut=" class="btn btn--ghost btn--sm {% if not request.GET.statut %}btn--primary{% endif %}">ğŸ“‹ Toutes</a>
        <a href="?statut=en_attente" class="btn btn--ghost btn--sm {% if request.GET.statut == 'en_attente' %}btn--warning{% endif %}">â³ En attente</a>
        <a href="?statut=servie" class="btn btn--ghost btn--sm {% if request.GET.statut == 'servie' %}btn--info{% endif %}">ğŸ½ï¸ Servies</a>
        <a href="?statut=payee" class="btn btn--ghost btn--sm {% if request.GET.statut == 'payee' %}btn--success{% endif %}">âœ… PayÃ©es</a>
    </div>
</div>

<!-- Liste des commandes -->
<div class="card">
    <div class="card__header">
        <h3 class="card__title">Liste des commandes</h3>
        <span class="badge badge--neutral">{{ commandes|length }} commande{{ commandes|length|pluralize }}</span>
    </div>
    
    {% if commandes %}
    <div class="table-container">
        <table class="table">
            <thead>
                <tr>
                    <th>NÂ° Commande</th>
                    <th>Table</th>
                    <th>Montant</th>
                    <th>Statut</th>
                    <th>Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for c in commandes %}
                <tr>
                    <td>
                        <strong style="color: var(--accent-primary);">{{ c.numero_commande }}</strong>
                    </td>
                    <td>
                        <span class="badge badge--neutral">Table {{ c.table.numero_table }}</span>
                    </td>
                    <td>
                        <strong>{{ c.montant_total }}â‚¬</strong>
                    </td>
                    <td>
                        <span class="badge {% if c.statut == 'en_attente' %}badge--warning{% elif c.statut == 'servie' %}badge--info{% elif c.statut == 'payee' %}badge--success{% else %}badge--neutral{% endif %}">
                            {% if c.statut == 'en_attente' %}â³{% elif c.statut == 'servie' %}ğŸ½ï¸{% elif c.statut == 'payee' %}âœ…{% endif %}
                            {{ c.get_statut_display }}
                        </span>
                    </td>
                    <td>
                        <span style="color: var(--text-secondary); font-size: 13px;">
                            {{ c.date_commande|date:"d/m/Y H:i" }}
                        </span>
                    </td>
                    <td>
                        <div class="btn-group">
                            <a class="btn btn--sm btn--ghost" href="{% url 'orders:view_order' c.id %}">ğŸ‘ï¸ Voir</a>
                            {% if c.statut == 'en_attente' %}
                                <a class="btn btn--sm btn--primary" href="{% url 'orders:mark_order_served' c.id %}">ğŸ½ï¸ Servir</a>
                            {% endif %}
                            {% if c.statut == 'servie' %}
                                <a class="btn btn--sm btn--success" href="{% url 'orders:mark_order_paid' c.id %}">ğŸ’³ Payer</a>
                            {% endif %}
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="empty-state">
        <div class="empty-state__icon">ğŸ“‹</div>
        <h3 class="empty-state__title">Aucune commande</h3>
        <p class="empty-state__description">Les commandes apparaÃ®tront ici une fois passÃ©es par les clients</p>
    </div>
    {% endif %}
</div>
{% endblock %}
